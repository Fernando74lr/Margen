<!-- Extension -->
{% extends 'core/base.html' %}

<!-- Load Static -->
{% load static %}

<!-- Title -->
{% block title %}Reports{% endblock %}

<!-- Custom Tag -->

<!-- Content -->
{% block content %}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
  <h1 class="h2">Reportes</h1>
    <div class="btn-toolbar mb-2 mb-md-0">
      <div class="btn-group me-2">
        <a href="{% url 'results' %}"><button type="button" class="btn btn-sm btn-outline-success">Export</button></a>
      </div>
    </div>
  </div>

  {% load tag_extras %}
  <h4>Generar reporte a partir de un rango de fechas</h4>
  <div class="container">
    <p>
      Primero define un rango de fechas en el siguiente campo y después presiona el botón
      <u>Obtener datos</u> para previsualizar las tablas.
    </p>

    <h6>Rango de fechas</h6>
    <div id="reportrange" class="dropdown-toggle" style="border-radius:5px; background: #fff; cursor: pointer; padding: 5px 10px; border: 1px solid #ccc; width: 17.5%">
        </span> <span></span>
    </div><br>

    <a id="getDataButton"><button type="button" class="btn btn-sm btn-outline-primary mr-2">
      Obtener datos
    </button></a><br>
    
    <br>
    {% if SqlServerConn %}
      {% for enterprise in SqlServerConn %}
        {% if enterprise %}
          <div id="titleAndFilter">
            <h5 style="margin-bottom:15px;">{{enterprise.0.1}}</h5>
            <div>
              <input type="text" style="width:235px;height:35px;border-radius:5px;" class="inputFilter" id="input{{ forloop.counter }}" onkeyup="myFunction('input{{ forloop.counter }}', 'example{{ forloop.counter }}')" placeholder="¡Busca por cualquier campo!" title="Filtro">
            </div>
          </div>
          <table id="example{{ forloop.counter }}" class="table table-striped table-bordered table-sm" style="margin-left:-6.5%">
            <thead class="table-dark">
              <tr>
                <th class="centerText">#</th>
                <th class="centerText">Serie Doc.</th>
                <th class="centerText">Corporación </th>
                <th class="centerText">Folio</th>
                <th class="centerText">Fecha</th>
                <th class="centerText">RFC</th>
                <th class="centerText">ID Cliente Proveedor</th>
                <th class="centerText">Razón Social</th>
                <th class="centerText">ID Agente</th>
                <!-- <th class="centerText">Observaciones</th> -->
                <th class="centerText">Cancelado</th>
                <th class="centerText">Neto</th>
                <th class="centerText">Impuesto1</th>
                <th class="centerText">Total</th>
                <th class="centerText">Método de pago</th>
                <th class="centerText">GUID Doc.</th>
                <th class="centerText">Usuario</th>
                <th class="centerText">ID Doc.</th>
                <th class="centerText">Mov. Obv.</th>
              </tr>
            </thead>
            {% for data in enterprise %}
              <tbody>
                <tr>
                  <td scope="row" class="centerText">{{ forloop.counter }}</td>
                  <!-- Serie Documento -->
                  <td class="centerText">{{data.2}}</td>
                  <!-- Corporación  -->
                  <td class="centerText">{{data.1}}</td>
                  <!-- Folio -->
                  <td class="centerText">{{data.3}}</td>
                  <!-- Fecha -->
                  <td class="centerText">{% formatDate data.4 %}</td>
                  <!-- RFC -->
                  <td class="centerText">{{data.7}}</td>
                  <!-- ID Cliente Proveedor -->
                  <td class="centerText">{{data.5}}</td>
                  <!-- Razón Social -->
                  <td class="centerText">{{data.6}}</td>
                  <!-- ID Agente -->
                  <td class="centerText">{{data.8}}</td>
                  <!-- Cancelado -->
                  <td class="centerText">{{data.9}}</td>
                  <!-- Observaciones -->
                  <!-- <td class="centerText">{{data.10}}</td>  -->
                  <!-- Neto -->
                  <td class="centerText">{{data.11}}</td>
                  <!-- Impuesto1 -->
                  <td class="centerText">{{data.12}}</td>
                  <!-- Total -->
                  <td class="centerText">{{data.13}}</td>
                  <!-- Método de pago -->
                  <td class="centerText">{{data.14}}</td>
                  <!-- GUID Documento -->
                  <td class="centerText">{{data.15}}</td>
                  <!-- Usuario -->
                  <td class="centerText">{{data.16}}</td>
                  <!-- ID Documento -->
                  <td class="centerText">{{data.17}}</td>
                  <!-- Mov. Obv. -->
                  <td class="centerText">{{data.18}}</td>
                </tr>
              </tbody>
            {% endfor %}
          </table>
          <br>
        {% endif %}
    {% endfor %}
    {% endif %}
  </div>
{% endblock %}